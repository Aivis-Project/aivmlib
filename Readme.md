
# aivmlib

ğŸ’  **aivmlib**: **Ai**vis **V**oice **M**odel File (.aivm) Utility **Lib**rary

**AIVM** (**Ai**vis **V**oice **M**odel) ã¯ã€å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«ãƒ»ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ãƒ™ã‚¯ãƒˆãƒ«ãƒ»è©±è€…ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ï¼ˆåå‰ / æ¦‚è¦ / ã‚¢ã‚¤ã‚³ãƒ³ / ãƒœã‚¤ã‚¹ã‚µãƒ³ãƒ—ãƒ« ãªã©ï¼‰ã‚’ 1 ã¤ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã‚®ãƒ¥ãƒƒã¨ã¾ã¨ã‚ãŸã€AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ç”¨ã‚ªãƒ¼ãƒ—ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§ã™ã€‚

[AivisSpeech](https://github.com/Aivis-Project/AivisSpeech) / [AivisSpeech-Engine](https://github.com/Aivis-Project/AivisSpeech-Engine) ã‚’ã¯ã˜ã‚ã¨ã—ãŸå¯¾å¿œã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã« AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã§ã€AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã‚’ç°¡å˜ã«åˆ©ç”¨ã§ãã¾ã™ã€‚

ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã¯ã€AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿æ›¸ãã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ã‚’æä¾›ã—ã¾ã™ã€‚  

> [!TIP]  
> **[AIVM Generator](https://aivm-generator.aivis-project.com/) ã§ã¯ã€ãƒ–ãƒ©ã‚¦ã‚¶ä¸Šã® GUI ã§ AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆãƒ»ç·¨é›†ã§ãã¾ã™ã€‚**  
> æ©Ÿèƒ½çš„ã«ã¯ aivmlib ã¨åŒã˜ã§ã™ã€‚æ‰‹å‹•ã§ AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆãƒ»ç·¨é›†ã™ã‚‹éš›ã¯ AIVM Generator ã®åˆ©ç”¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚

## Installation

pip ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ« `aivmlib` ã‚‚è‡ªå‹•çš„ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¾ã™ã€‚

```bash
pip install aivmlib
```

## Usage

ä»¥ä¸‹ã« CLI ãƒ„ãƒ¼ãƒ«è‡ªä½“ã®ä½¿ã„æ–¹ã‚’ç¤ºã—ã¾ã™ã€‚

```bash
$ aivmlib --help

 Usage: aivmlib [OPTIONS] COMMAND [ARGS]...

 Aivis Voice Model File (.aivm) Utility Library

â•­â”€ Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ --install-completion          Install completion for the current shell.           â”‚
â”‚ --show-completion             Show completion for the current shell, to copy it   â”‚
â”‚                               or customize the installation.                      â”‚
â”‚ --help                        Show this message and exit.                         â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â•­â”€ Commands â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ create-aivm     ä¸ãˆã‚‰ã‚ŒãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£, å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«, ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿,     â”‚
â”‚                 ã‚¹ã‚¿ã‚¤ãƒ«ãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰ AIVM ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ãŸä¸Šã§ã€              â”‚
â”‚                 ãã‚Œã‚’æ›¸ãè¾¼ã‚“ã ä»®ã® AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹                      â”‚
â”‚ show-metadata   æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã® AIVM ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«è¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ AIVM             â”‚
â”‚                 ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚„ã™ãå‡ºåŠ›ã™ã‚‹                                      â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

$ aivmlib create-aivm --help

 Usage: aivmlib create-aivm [OPTIONS]

 ä¸ãˆã‚‰ã‚ŒãŸã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£, å­¦ç¿’æ¸ˆã¿ãƒ¢ãƒ‡ãƒ«, ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿, ã‚¹ã‚¿ã‚¤ãƒ«ãƒ™ã‚¯ãƒˆãƒ«ã‹ã‚‰
 AIVM ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆã—ãŸä¸Šã§ã€ ãã‚Œã‚’æ›¸ãè¾¼ã‚“ã ä»®ã® AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã™ã‚‹

â•­â”€ Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ *  --output              -o      PATH                    Path to the output AIVM  â”‚
â”‚                                                          file                     â”‚
â”‚                                                          [default: None]          â”‚
â”‚                                                          [required]               â”‚
â”‚ *  --model               -m      PATH                    Path to the Safetensors  â”‚
â”‚                                                          model file               â”‚
â”‚                                                          [default: None]          â”‚
â”‚                                                          [required]               â”‚
â”‚ *  --hyper-parameters    -h      PATH                    Path to the hyper        â”‚
â”‚                                                          parameters file          â”‚
â”‚                                                          [default: None]          â”‚
â”‚                                                          [required]               â”‚
â”‚    --style-vectors       -s      PATH                    Path to the style        â”‚
â”‚                                                          vectors file (optional)  â”‚
â”‚                                                          [default: None]          â”‚
â”‚    --model-architecture  -a      [Style-Bert-VITS2|Styl  Model architecture       â”‚
â”‚                                  e-Bert-VITS2            [default:                â”‚
â”‚                                  (JP-Extra)]             Style-Bert-VITS2         â”‚
â”‚                                                          (JP-Extra)]              â”‚
â”‚    --help                                                Show this message and    â”‚
â”‚                                                          exit.                    â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

$ aivmlib show-metadata --help

 Usage: aivmlib show-metadata [OPTIONS] AIVM_FILE_PATH

 æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ã® AIVM ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«è¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ AIVM ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¦‹ã‚„ã™ãå‡ºåŠ›ã™ã‚‹

â•­â”€ Arguments â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ *    aivm_file_path      PATH  Path to the AIVM file [default: None] [required]   â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
â•­â”€ Options â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ --help          Show this message and exit.                                       â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

> [!TIP]  
> ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦ã®ä½¿ã„æ–¹ã¯ã€[`__main__.py`](aivmlib/__main__.py) ã«å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ CLI ãƒ„ãƒ¼ãƒ«ã®å®Ÿè£…ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚  

> [!IMPORTANT]  
> aivmlib ã¯ã€AIVM ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®èª­ã¿è¾¼ã¿/æ›¸ãè¾¼ã¿æ©Ÿèƒ½ã®ã¿ã‚’æœ‰ã™ã‚‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚  
> å„ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã”ã¨ã® AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®æ¨è«–ãƒ­ã‚¸ãƒƒã‚¯ã‚„ã€aivmlib ã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã©ã®ã‚ˆã†ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æç¤ºã™ã‚‹ã‹ã¯ã€ã™ã¹ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®åˆ©ç”¨è€…ã«å§”ã­ã‚‰ã‚Œã¦ã„ã¾ã™ã€‚

## AIVM File Format Specification

ä»¥ä¸‹ã« AIVM ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®ä»•æ§˜ã‚’ç¤ºã™ã€‚

**AIVM** (**Ai**vis **V**oice **M**odel) ã¯ã€[Safetensors](https://github.com/huggingface/safetensors) (.safetensors) å½¢å¼ã§ä¿å­˜ã•ã‚ŒãŸå­¦ç¿’æ¸ˆã¿ AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼é ˜åŸŸã®ä¸­ã«ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦è©±è€…ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ ([AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ](#aivm-manifest-specification-version-10)) ãƒ»ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«ãƒ™ã‚¯ãƒˆãƒ«ã¨ã„ã£ãŸå„ç¨®æƒ…å ±ã‚’æ ¼ç´ã—ãŸã€Safetensors å½¢å¼ã®æ‹¡å¼µä»•æ§˜ã§ã‚ã‚‹ã€‚  
ã€ŒAI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«å‘ã‘ã®ã€Safetensors å½¢å¼ã®å…±é€šãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿è¨˜è¿°ä»•æ§˜ã€ã¨ã‚‚è¨€ãˆã‚‹ã€‚

### æ¦‚è¦

å­¦ç¿’æ¸ˆã¿ AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã¨ã€ãã®åˆ©ç”¨ã«å¿…è¦ãªå„ç¨®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å˜ä¸€ãƒ•ã‚¡ã‚¤ãƒ«ã«ã¾ã¨ã‚ã‚‹ã“ã¨ã§ã€**ãƒ•ã‚¡ã‚¤ãƒ«ã®æ•£é€¸ã‚„æ··ä¹±ã‚’é˜²ãã€ãƒ¢ãƒ‡ãƒ«ã®åˆ©ç”¨ã‚„å…±æœ‰ã‚’å®¹æ˜“ã«ã™ã‚‹ã“ã¨ã‚’ç›®çš„ã¨ã—ã¦ã„ã‚‹ã€‚**

**AIVM ä»•æ§˜ã¯ã€éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ä¾å­˜ã—ãªã„ã€‚**  
ç•°ãªã‚‹ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã‚’å…±é€šã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§æ‰±ãˆã‚‹ã‚ˆã†ã€æ‹¡å¼µæ€§ã‚„æ±ç”¨æ€§ã‚’è€ƒæ…®ã—ã¦è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ã€‚

å¤§å…ƒã®å­¦ç¿’æ¸ˆã¿ AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ãŒ Safetensors å½¢å¼ã§ä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãªã‚‰ã°ã€åŸå‰‡ã©ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã‚ã£ã¦ã‚‚ã€ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã—ã¦ AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç”Ÿæˆã§ãã‚‹ã€‚

> [!IMPORTANT]  
> **AIVM ä»•æ§˜ã¯ã€å„ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã”ã¨ã®æ¨è«–æ–¹æ³•ã‚’å®šç¾©ã—ãªã„ã€‚ã‚ãã¾ã§ã‚‚ã€ŒAI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’ã¾ã¨ã‚ãŸãƒ•ã‚¡ã‚¤ãƒ«ã€ã¨ã—ã¦ã®ä»•æ§˜ã®ã¿ã‚’å®šç¾©ã™ã‚‹ã€‚**  
> ãŸã¨ãˆã°æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã¯ PyTorch ç”¨ã‹ã‚‚ã—ã‚Œãªã„ã—ã€TensorFlow ç”¨ã‹ã‚‚ã—ã‚Œãªã„ã€‚  
> ã©ã®ã‚ˆã†ã« AI éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®æ¨è«–ã‚’è¡Œã†ã‹ã¯ã€AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®å®Ÿè£…ã«å§”ã­ã‚‰ã‚Œã¦ã„ã‚‹ã€‚

### Safetensors å½¢å¼ã¨ã®äº’æ›æ€§

Safetensors å½¢å¼ã®æ‹¡å¼µä»•æ§˜ã®ãŸã‚ã€ãã®ã¾ã¾é€šå¸¸ã® Safetensors ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã€‚

Safetensors åŒæ§˜ã€å…ˆé ­ 8bytes ã®ç¬¦å·ãªã— Little-Endian 64bit æ•´æ•°ãŒãƒ˜ãƒƒãƒ€ãƒ¼ã‚µã‚¤ã‚ºã€ãã®å¾Œã‚ã«ãƒ˜ãƒƒãƒ€ãƒ¼ã‚µã‚¤ã‚ºã®é•·ã•ã ã‘ UTF-8 ã® JSON æ–‡å­—åˆ—ãŒç¶šãã€‚  
Safetensors ã®ãƒ˜ãƒƒãƒ€ãƒ¼ JSON ã«ã¯ãƒ†ãƒ³ã‚½ãƒ«ã®ã‚ªãƒ•ã‚»ãƒƒãƒˆç­‰ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãŒã€`__metadata__` ã‚­ãƒ¼ã«ã¯ string ã‹ã‚‰ string ã¸ã® map ã‚’è‡ªç”±ã«è¨­å®šå¯èƒ½ãªä»•æ§˜ã§ã‚ã‚‹ã€‚

ã“ã®ä»•æ§˜ã‚’æ´»ç”¨ã—ã€AIVM ã¯ `__metadata__` å†…ã®ä»¥ä¸‹ã®ã‚­ãƒ¼ã«æ¬¡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ JSON æ–‡å­—åˆ—ã«ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚ºã—ã¦æ ¼ç´ã™ã‚‹ã€‚

- **`aivm_manifest` : [AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ](#aivm-manifest-specification-version-10)**
  - JSON æ–‡å­—åˆ—ã§æ ¼ç´ã•ã‚Œã‚‹
  - ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚„è©±è€…ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€å¤§åŠã®æƒ…å ±ãŒå«ã¾ã‚Œã‚‹
- **`aivm_hyper_parameters` : éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ãƒã‚¤ãƒ‘ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**
  - æ ¼ç´ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä¾å­˜
  - `Style-Bert-VITS2`ãƒ»`Style-Bert-VITS2 (JP-Extra)` ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ JSON æ–‡å­—åˆ—ã§æ ¼ç´ã•ã‚Œã‚‹
- **`aivm_style_vectors` : Base64 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸéŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ«ãƒ™ã‚¯ãƒˆãƒ« (ãƒã‚¤ãƒŠãƒª)**
  - Base64 ãƒ‡ã‚³ãƒ¼ãƒ‰å¾Œã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ä¾å­˜
  - `Style-Bert-VITS2`ãƒ»`Style-Bert-VITS2 (JP-Extra)` ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã¯ NumPy é…åˆ— (.npy) ã‚’ Base64 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ãŸæ–‡å­—åˆ—ã§æ ¼ç´ã•ã‚Œã‚‹
  - ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ¬¡ç¬¬ã§ã¯çœç•¥ã•ã‚Œã†ã‚‹

### å‚è€ƒè³‡æ–™

- [Safetensors](https://github.com/huggingface/safetensors)
- [Safetensors Metadata Parsing](https://huggingface.co/docs/safetensors/main/en/metadata_parsing)

## AIVM Manifest Specification (Version 1.0)

ä»¥ä¸‹ã« AIVM ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ã€AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ (Version 1.0) ã®ä»•æ§˜ã‚’ç¤ºã™ã€‚

AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã¯ã€JSON ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§è¨˜è¿°ã•ã‚ŒãŸ UTF-8 æ–‡å­—åˆ—ã§ã‚ã‚‹ã€‚

**AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã«ã¯ã€ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ (= AIVM ãƒ•ã‚¡ã‚¤ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³)ãƒ»ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ»ãƒ¢ãƒ‡ãƒ«åãƒ»è©±è€…ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãƒ»ã‚¹ã‚¿ã‚¤ãƒ«æƒ…å ±ãªã©ã®ã€éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®åˆ©ç”¨ã«å¿…è¦ã¨ãªã‚‹æ§˜ã€…ãªæƒ…å ±ãŒå«ã¾ã‚Œã‚‹ã€‚**  
JSON ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã®éƒ½åˆä¸Šã€ç”»åƒã‚„éŸ³å£°ãƒ‡ãƒ¼ã‚¿ã¯ Base64 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸæ–‡å­—åˆ—ã§æ ¼ç´ã•ã‚Œã‚‹ã€‚

### ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

- `Style-Bert-VITS2`
- `Style-Bert-VITS2 (JP-Extra)`

> [!IMPORTANT]  
> **AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã¯ã€è‡ªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã¯ã‚µãƒãƒ¼ãƒˆå¯¾è±¡å¤–ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã® AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€é©åˆ‡ã«ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚**  
> ãŸã¨ãˆã° `Style-Bert-VITS2 (JP-Extra)` ä»¥å¤–ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’ã‚µãƒãƒ¼ãƒˆã—ãªã„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã§ã¯ã€`Style-Bert-VITS2` ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã® AIVM ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’æ±‚ã‚ã‚‰ã‚ŒãŸéš›ã«ã€Œã“ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã¯å¯¾å¿œã—ã¦ã„ã¾ã›ã‚“ã€ã¨ã‚¢ãƒ©ãƒ¼ãƒˆã‚’è¡¨ç¤ºã—ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’ä¸­æ­¢ã™ã‚‹ã‚ˆã†å®Ÿè£…ã™ã¹ãã€‚

> [!IMPORTANT]  
> **æŠ€è¡“çš„ã«ã¯ä¸Šè¨˜ä»¥å¤–ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã‚‚æ ¼ç´ã§ãã¾ã™ãŒã€AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ (Version 1.0) ä»•æ§˜ã§å…¬å¼ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ–‡å­—åˆ—ã¯ä¸Šè¨˜ã®ã¿ã€‚**  
> ç‹¬è‡ªã«ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ–‡å­—åˆ—ã‚’å®šç¾©ã™ã‚‹å ´åˆã¯ã€æ—¢å­˜ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã®åå‰è¡çªã‚„ç•°ãªã‚‹ã‚½ãƒ•ãƒˆé–“ã§ã®è¡¨è¨˜æºã‚ŒãŒç™ºç”Ÿã—ãªã„ã‚ˆã†ã€ç´°å¿ƒã®æ³¨æ„ã‚’æ‰•ã†å¿…è¦ãŒã‚ã‚‹ã€‚  
> ãªã‚‹ã¹ãã“ã®ãƒªãƒã‚¸ãƒˆãƒªã«ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ä¿¡ã—ã€å…¬å¼ã« AIVM ä»•æ§˜ã«æ–°ã—ã„ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚µãƒãƒ¼ãƒˆã‚’è¿½åŠ ã™ã‚‹å½¢ã‚’å–ã‚‹ã“ã¨ã‚’æ¨å¥¨ã™ã‚‹ã€‚

### AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©

ä»¥ä¸‹ã¯ AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆ (Version 1.0) ä»•æ§˜æ™‚ç‚¹ã§ã® AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰å®šç¾©ã‚’ç¤ºã™ ([Pydantic ã‚¹ã‚­ãƒ¼ãƒå®šç¾©](aivmlib/schemas/aivm_manifest.py) ã‚ˆã‚ŠæŠœç²‹) ã€‚

> [!IMPORTANT]  
> **AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆå†…ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã¯ã€ä»Šå¾Œ AIVM ä»•æ§˜ãŒæ›´æ–°ã•ã‚ŒãŸéš›ã«è¿½åŠ ãƒ»æ‹¡å¼µãƒ»å‰Šé™¤ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã€‚**  
> ä»Šå¾Œã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°ã‚„è¿½åŠ ã®ãƒ¢ãƒ‡ãƒ«ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®ã‚µãƒãƒ¼ãƒˆã«ã‚ˆã‚Šã€AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã‚„ AIVM ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆè‡ªä½“ã«æ–°ã—ã„ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒè¿½åŠ ã•ã‚Œã‚‹ã“ã¨ã‚‚ååˆ†è€ƒãˆã‚‰ã‚Œã‚‹ã€‚  
> ç¾åœ¨æœ‰åŠ¹ãª AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¯ 1.0 ã®ã¿ã€‚

```python
class ModelArchitecture(StrEnum):
    StyleBertVITS2 = 'Style-Bert-VITS2'
    StyleBertVITS2JPExtra = 'Style-Bert-VITS2 (JP-Extra)'

class AivmManifest(BaseModel):
    """ AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®ã‚¹ã‚­ãƒ¼ãƒ """
    # AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (ex: 1.0)
    # ç¾åœ¨ã¯ 1.0 ã®ã¿ã‚µãƒãƒ¼ãƒˆ
    manifest_version: Annotated[str, constr(pattern=r'^1\.0$')]
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®åå‰
    name: Annotated[str, constr(min_length=1)]
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®èª¬æ˜ (çœç•¥æ™‚ã¯ç©ºæ–‡å­—åˆ—ã«ãªã‚‹)
    description: str = ''
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®åˆ©ç”¨è¦ç´„ (Markdown å½¢å¼ / çœç•¥æ™‚ã¯ç©ºæ–‡å­—åˆ—ã«ãªã‚‹)
    # ã‚«ã‚¹ã‚¿ãƒ åˆ©ç”¨è¦ç´„ã‚’è¨­å®šã™ã‚‹å ´åˆã‚’é™¤ãã€åŸå‰‡å„ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¸ã® URL ã¸ã®ãƒªãƒ³ã‚¯ã®ã¿ã‚’è¨˜è¿°ã™ã‚‹
    # ä¾‹: [CC BY-SA 4.0](https://creativecommons.org/licenses/by-sa/4.0/)
    terms_of_use: str = ''
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ (éŸ³å£°åˆæˆæŠ€è¡“ã®ç¨®é¡)
    model_architecture: ModelArchitecture
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«å­¦ç¿’æ™‚ã®ã‚¨ãƒãƒƒã‚¯æ•° (çœç•¥æ™‚ã¯ None ã«ãªã‚‹)
    training_epochs: Annotated[int, Field(ge=0)] | None = None
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«å­¦ç¿’æ™‚ã®ã‚¹ãƒ†ãƒƒãƒ—æ•° (çœç•¥æ™‚ã¯ None ã«ãªã‚‹)
    training_steps: Annotated[int, Field(ge=0)] | None = None
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ UUID
    uuid: UUID
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ (SemVer 2.0 æº–æ‹  / ex: 1.0.0)
    version: Annotated[str, constr(pattern=r'^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$')]
    # éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«ã®è©±è€…æƒ…å ± (æœ€ä½ 1 äººä»¥ä¸Šã®è©±è€…ãŒå¿…è¦)
    speakers: list[AivmManifestSpeaker]

class AivmManifestSpeaker(BaseModel):
    """ AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®è©±è€…æƒ…å ± """
    # è©±è€…ã®åå‰
    name: Annotated[str, constr(min_length=1)]
    # è©±è€…ã®ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒ (Data URL)
    # ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¯ 512Ã—512 ã® JPEG (image/jpeg)ãƒ»PNG (image/png) ã®ã„ãšã‚Œã‹ (JPEG ã‚’æ¨å¥¨)
    icon: Annotated[str, constr(pattern=r'^data:image/(jpeg|png);base64,[A-Za-z0-9+/=]+$')]
    # è©±è€…ã®å¯¾å¿œè¨€èªã®ãƒªã‚¹ãƒˆ (ja, en, zh ã®ã‚ˆã†ãª ISO 639-1 è¨€èªã‚³ãƒ¼ãƒ‰)
    supported_languages: list[Annotated[str, constr(min_length=2, max_length=2)]]
    # è©±è€…ã‚’ä¸€æ„ã«è­˜åˆ¥ã™ã‚‹ UUID
    uuid: UUID
    # è©±è€…ã®ãƒ­ãƒ¼ã‚«ãƒ« ID (ã“ã®éŸ³å£°åˆæˆãƒ¢ãƒ‡ãƒ«å†…ã§è©±è€…ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ä¸€æ„ãªãƒ­ãƒ¼ã‚«ãƒ« ID ã§ã€uuid ã¨ã¯ç•°ãªã‚‹)
    local_id: Annotated[int, Field(ge=0)]
    # è©±è€…ã®ã‚¹ã‚¿ã‚¤ãƒ«æƒ…å ± (æœ€ä½ 1 ã¤ä»¥ä¸Šã®ã‚¹ã‚¿ã‚¤ãƒ«ãŒå¿…è¦)
    styles: list[AivmManifestSpeakerStyle]

class AivmManifestSpeakerStyle(BaseModel):
    """ AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®è©±è€…ã‚¹ã‚¿ã‚¤ãƒ«æƒ…å ± """
    # ã‚¹ã‚¿ã‚¤ãƒ«ã®åå‰
    name: Annotated[str, constr(min_length=1)]
    # ã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒ (Data URL, çœç•¥å¯èƒ½)
    # çœç•¥æ™‚ã¯è©±è€…ã®ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒãŒã‚¹ã‚¿ã‚¤ãƒ«ã®ã‚¢ã‚¤ã‚³ãƒ³ç”»åƒã¨ã—ã¦ä½¿ã‚ã‚Œã‚‹æƒ³å®š
    # ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¯ 512Ã—512 ã® JPEG (image/jpeg)ãƒ»PNG (image/png) ã®ã„ãšã‚Œã‹ (JPEG ã‚’æ¨å¥¨)
    icon: Annotated[str, constr(pattern=r'^data:image/(jpeg|png);base64,[A-Za-z0-9+/=]+$')] | None = None
    # ã‚¹ã‚¿ã‚¤ãƒ«ã® ID (ã“ã®è©±è€…å†…ã§ã‚¹ã‚¿ã‚¤ãƒ«ã‚’è­˜åˆ¥ã™ã‚‹ãŸã‚ã®ä¸€æ„ãªãƒ­ãƒ¼ã‚«ãƒ« ID ã§ã€uuid ã¨ã¯ç•°ãªã‚‹)
    local_id: Annotated[int, Field(ge=0, le=31)]
    # ã‚¹ã‚¿ã‚¤ãƒ«ã®ãƒœã‚¤ã‚¹ã‚µãƒ³ãƒ—ãƒ« (çœç•¥æ™‚ã¯ç©ºé…åˆ—ã«ãªã‚‹)
    voice_samples: list[AivmManifestVoiceSample] = []

class AivmManifestVoiceSample(BaseModel):
    """ AIVM ãƒãƒ‹ãƒ•ã‚§ã‚¹ãƒˆã®ãƒœã‚¤ã‚¹ã‚µãƒ³ãƒ—ãƒ«æƒ…å ± """
    # ãƒœã‚¤ã‚¹ã‚µãƒ³ãƒ—ãƒ«ã®éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ« (Data URL)
    # éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¯ WAV (audio/wav, Codec: PCM 16bit)ãƒ»M4A (audio/mp4, Codec: AAC-LC) ã®ã„ãšã‚Œã‹ (M4A ã‚’æ¨å¥¨)
    audio: Annotated[str, constr(pattern=r'^data:audio/(wav|mp4);base64,[A-Za-z0-9+/=]+$')]
    # ãƒœã‚¤ã‚¹ã‚µãƒ³ãƒ—ãƒ«ã®æ›¸ãèµ·ã“ã—æ–‡
    # æ›¸ãèµ·ã“ã—æ–‡ã¯éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã®ç™ºè©±å†…å®¹ã¨ä¸€è‡´ã—ã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹
    transcript: Annotated[str, constr(min_length=1)]
```

## License

[MIT License](License.txt)
